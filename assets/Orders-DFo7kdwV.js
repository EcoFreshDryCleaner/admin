import{i as E,r as m,j as N,k as T,g as j,m as M,o as l,a as s,c as i,e as P,f as b,N as k,F as D,n as C,t as o,p as g,b as d,d as r}from"./index-peUOkrNM.js";import{F as u}from"./index.es-YoZnc2XA.js";import{_ as H}from"./DashboardLayout-DxZomJu8.js";import{_ as z,a as Q,g as q,b as G,u as J}from"./_plugin-vue_export-helper-CaeaE_Fu.js";const W={class:"orders-container"},X={class:"filters-section"},Y={class:"filters-row"},Z={class:"filter-group"},K={class:"filter-group"},ss=["value"],es={class:"filter-group"},ts={class:"orders-card"},as={class:"card-body"},os={key:0,class:"empty-state"},ls={key:1,class:"orders-table"},is={class:"table-cell order-status"},ns={class:"order-number"},cs={class:"order-status-badge"},ds={class:"table-cell customer-info"},rs={class:"customer-name"},us=["onClick"],vs={class:"toggle-text"},_s={key:0,class:"customer-details"},ps={class:"detail-item"},fs={class:"detail-value"},ms={class:"detail-item"},gs={class:"detail-value"},hs={class:"table-cell location-info"},ys={class:"location-name"},bs={class:"service-type-badge"},ks=["onClick"],Ds={class:"toggle-text"},Cs={key:0,class:"location-details"},ws={class:"detail-item"},Os={class:"detail-value"},Ss={class:"table-cell service-date"},Ps={class:"table-cell items"},Ls={class:"table-cell total-price"},Us={class:"table-cell actions"},xs=["onUpdate:modelValue","onChange"],Ns={class:"stats-grid"},As={class:"stats-card"},Vs={class:"stats-icon"},Fs={class:"stats-content"},$s={class:"stats-value"},Bs={class:"stats-card"},Is={class:"stats-icon"},Rs={class:"stats-content"},Es={class:"stats-value"},Ts={class:"stats-card"},js={class:"stats-icon"},Ms={class:"stats-content"},Hs={class:"stats-value"},zs={class:"stats-card"},Qs={class:"stats-icon"},qs={class:"stats-content"},Gs={class:"stats-value"},Js={class:"stats-card"},Ws={class:"stats-icon"},Xs={class:"stats-content"},Ys={class:"stats-value"},Zs={class:"stats-card"},Ks={class:"stats-icon"},se={class:"stats-content"},ee={class:"stats-value"},te={key:0,class:"location-stats-section"},ae={class:"location-stats-grid"},oe=["onClick"],le={class:"location-stat-header"},ie={class:"location-name"},ne={class:"location-count"},ce={class:"location-stat-breakdown"},de={class:"stat-item"},re={class:"stat-item"},ue={class:"stat-item"},ve={__name:"Orders",setup(_e){const n=E(Q),c=m({total:0,pending:0,confirmed:0,picked_up:0,dropped_off:0,in_progress:0,cleaning:0,ready:0,ready_for_pickup:0,out_for_delivery:0,delivered:0,completed:0,cancelled:0,inProgress:0}),h=m(""),v=m(""),w=m("date_placed"),_=m(new Set),p=m(new Set),O=N(()=>{if(!n.value)return[];const a=new Set;return n.value.forEach(e=>{e.service_location&&a.add(e.service_location)}),Array.from(a).sort()}),L=N(()=>{if(!n.value)return[];let a=n.value;return h.value&&(a=a.filter(e=>e.status===h.value)),v.value&&(a=a.filter(e=>e.service_location===v.value)),a=[...a].sort((e,t)=>{switch(w.value){case"date_placed":return new Date(t.date_placed?.toDate())-new Date(e.date_placed?.toDate());case"date_placed_asc":return new Date(e.date_placed?.toDate())-new Date(t.date_placed?.toDate());case"service_date":return new Date(t.service_date?.toDate())-new Date(e.service_date?.toDate());case"order_number":return e.order_number?.localeCompare(t.order_number);case"customer_name":return e.customer_name?.localeCompare(t.customer_name);case"total_price":return(t.total_price||0)-(e.total_price||0);default:return 0}}),a}),A=a=>a?new Date(a.toDate()).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A",V=a=>a.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "),F=a=>G(a),S=a=>a?a.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "):"Unknown Location",$=a=>n.value?n.value.filter(e=>e.service_location===a).length:0,y=(a,e)=>n.value?n.value.filter(t=>t.service_location===a&&t.status===e).length:0,B=a=>{_.value.has(a)?_.value.delete(a):_.value.add(a)},I=a=>{p.value.has(a)?p.value.delete(a):p.value.add(a)},R=async(a,e)=>{try{await J(a,e),await U()}catch(t){console.error("Error updating order status:",t)}},U=async()=>{try{const a=await q();c.value=a}catch(a){console.error("Error loading orders stats:",a)}};return T(async()=>{await U()}),(a,e)=>(l(),j(H,null,{default:M(()=>[s("div",W,[e[20]||(e[20]=s("div",{class:"page-header"},[s("h1",{class:"page-title"},"Orders Management"),s("p",{class:"page-subtitle"},"View and manage customer orders")],-1)),s("div",X,[s("div",Y,[s("div",Z,[e[4]||(e[4]=s("label",{for:"status-filter",class:"filter-label"},"Filter by Status:",-1)),b(s("select",{"onUpdate:modelValue":e[0]||(e[0]=t=>h.value=t),id:"status-filter",class:"filter-select"},[...e[3]||(e[3]=[s("option",{value:""},"All Orders",-1),s("option",{value:"pending"},"Pending",-1),s("option",{value:"confirmed"},"Confirmed",-1),s("option",{value:"picked_up"},"Picked Up",-1),s("option",{value:"dropped_off"},"Dropped Off",-1),s("option",{value:"in_progress"},"In Progress",-1),s("option",{value:"cleaning"},"Cleaning",-1),s("option",{value:"ready"},"Ready",-1),s("option",{value:"ready_for_pickup"},"Ready for Pickup",-1),s("option",{value:"out_for_delivery"},"Out for Delivery",-1),s("option",{value:"delivered"},"Delivered",-1),s("option",{value:"completed"},"Completed",-1),s("option",{value:"cancelled"},"Cancelled",-1)])],512),[[k,h.value]])]),s("div",K,[e[6]||(e[6]=s("label",{for:"location-filter",class:"filter-label"},"Filter by Location:",-1)),b(s("select",{"onUpdate:modelValue":e[1]||(e[1]=t=>v.value=t),id:"location-filter",class:"filter-select"},[e[5]||(e[5]=s("option",{value:""},"All Locations",-1)),(l(!0),i(D,null,C(O.value,t=>(l(),i("option",{key:t,value:t},o(S(t)),9,ss))),128))],512),[[k,v.value]])]),s("div",es,[e[8]||(e[8]=s("label",{for:"sort-by",class:"filter-label"},"Sort by:",-1)),b(s("select",{"onUpdate:modelValue":e[2]||(e[2]=t=>w.value=t),id:"sort-by",class:"filter-select"},[...e[7]||(e[7]=[s("option",{value:"date_placed"},"Date Placed (Newest)",-1),s("option",{value:"date_placed_asc"},"Date Placed (Oldest)",-1),s("option",{value:"service_date"},"Service Date",-1),s("option",{value:"order_number"},"Order Number",-1),s("option",{value:"customer_name"},"Customer Name",-1),s("option",{value:"total_price"},"Total Price",-1)])],512),[[k,w.value]])])])]),s("div",ts,[e[12]||(e[12]=s("div",{class:"card-header"},[s("h3",{class:"card-title"},"Orders")],-1)),s("div",as,[L.value.length===0?(l(),i("div",os,[...e[9]||(e[9]=[s("p",{class:"empty-text"},"No orders found",-1)])])):(l(),i("div",ls,[e[11]||(e[11]=s("div",{class:"table-header"},[s("div",{class:"table-cell"},"Order # & Status"),s("div",{class:"table-cell"},"Customer"),s("div",{class:"table-cell"},"Location"),s("div",{class:"table-cell"},"Service Date"),s("div",{class:"table-cell"},"Items"),s("div",{class:"table-cell"},"Total"),s("div",{class:"table-cell"},"Actions")],-1)),(l(!0),i(D,null,C(L.value,t=>(l(),i("div",{key:t.id,class:"table-row"},[s("div",is,[s("div",ns,[s("strong",null,o(t.order_number),1)]),s("div",cs,[s("span",{class:g(["status-badge",`status-${t.status}`])},o(F(t.status)),3)])]),s("div",ds,[s("div",rs,o(t.customer_name),1),s("button",{class:g(["customer-info-toggle",{expanded:_.value.has(t.id)}]),onClick:f=>B(t.id)},[s("span",vs,o(_.value.has(t.id)?"Hide Details":"Show Details"),1),d(r(u),{icon:_.value.has(t.id)?"fa-solid fa-chevron-up":"fa-solid fa-chevron-down",class:"toggle-icon"},null,8,["icon"])],10,us),_.value.has(t.id)?(l(),i("div",_s,[s("div",ps,[s("span",fs,o(t.customer_email),1)]),s("div",ms,[s("span",gs,o(t.customer_phone),1)])])):P("",!0)]),s("div",hs,[s("div",ys,o(t.service_location_name||S(t.service_location)),1),s("div",bs,[s("span",{class:g(["service-badge",`service-${t.service_type}`])},o(t.service_type==="pickup"?"Pick Up":"Drop Off"),3)]),s("button",{class:g(["location-info-toggle",{expanded:p.value.has(t.id)}]),onClick:f=>I(t.id)},[s("span",Ds,o(p.value.has(t.id)?"Hide Address":"Show Address"),1),d(r(u),{icon:p.value.has(t.id)?"fa-solid fa-chevron-up":"fa-solid fa-chevron-down",class:"toggle-icon"},null,8,["icon"])],10,ks),p.value.has(t.id)?(l(),i("div",Cs,[s("div",ws,[s("span",Os,o(t.service_location_address),1)])])):P("",!0)]),s("div",Ss,o(A(t.service_date)),1),s("div",Ps,[(l(!0),i(D,null,C(t.items,(f,x)=>(l(),i("div",{key:x,class:"item"},o(V(x))+": "+o(f),1))),128))]),s("div",Ls,"$"+o(t.total_price),1),s("div",Us,[b(s("select",{"onUpdate:modelValue":f=>t.status=f,onChange:f=>R(t.id,t.status),class:"status-select"},[...e[10]||(e[10]=[s("option",{value:"pending"},"Pending",-1),s("option",{value:"confirmed"},"Confirmed",-1),s("option",{value:"picked_up"},"Picked Up",-1),s("option",{value:"dropped_off"},"Dropped Off",-1),s("option",{value:"in_progress"},"In Progress",-1),s("option",{value:"cleaning"},"Cleaning",-1),s("option",{value:"ready"},"Ready",-1),s("option",{value:"ready_for_pickup"},"Ready for Pickup",-1),s("option",{value:"out_for_delivery"},"Out for Delivery",-1),s("option",{value:"delivered"},"Delivered",-1),s("option",{value:"completed"},"Completed",-1),s("option",{value:"cancelled"},"Cancelled",-1)])],40,xs),[[k,t.status]])])]))),128))]))])]),s("div",Ns,[s("div",As,[s("div",Vs,[d(r(u),{icon:"fa-solid fa-shopping-bag",class:"stats-icon-svg"})]),s("div",Fs,[e[13]||(e[13]=s("p",{class:"stats-label"},"Total Orders",-1)),s("p",$s,o(c.value.total),1)])]),s("div",Bs,[s("div",Is,[d(r(u),{icon:"fa-solid fa-clock",class:"stats-icon-svg"})]),s("div",Rs,[e[14]||(e[14]=s("p",{class:"stats-label"},"Pending",-1)),s("p",Es,o(c.value.pending),1)])]),s("div",Ts,[s("div",js,[d(r(u),{icon:"fa-solid fa-spinner",class:"stats-icon-svg"})]),s("div",Ms,[e[15]||(e[15]=s("p",{class:"stats-label"},"In Progress",-1)),s("p",Hs,o(c.value.inProgress),1)])]),s("div",zs,[s("div",Qs,[d(r(u),{icon:"fa-solid fa-soap",class:"stats-icon-svg"})]),s("div",qs,[e[16]||(e[16]=s("p",{class:"stats-label"},"Cleaning",-1)),s("p",Gs,o(c.value.cleaning),1)])]),s("div",Js,[s("div",Ws,[d(r(u),{icon:"fa-solid fa-check-circle",class:"stats-icon-svg"})]),s("div",Xs,[e[17]||(e[17]=s("p",{class:"stats-label"},"Ready",-1)),s("p",Ys,o(c.value.ready+c.value.ready_for_pickup),1)])]),s("div",Zs,[s("div",Ks,[d(r(u),{icon:"fa-solid fa-truck",class:"stats-icon-svg"})]),s("div",se,[e[18]||(e[18]=s("p",{class:"stats-label"},"Out for Delivery",-1)),s("p",ee,o(c.value.out_for_delivery),1)])])]),O.value.length>1?(l(),i("div",te,[e[19]||(e[19]=s("h3",{class:"location-stats-title"},"Orders by Location",-1)),s("div",ae,[(l(!0),i(D,null,C(O.value,t=>(l(),i("div",{key:t,class:g(["location-stat-card",{"active-location":v.value===t}]),onClick:f=>v.value=v.value===t?"":t},[s("div",le,[s("h4",ie,o(S(t)),1),s("span",ne,o($(t)),1)]),s("div",ce,[s("span",de,"Pending: "+o(y(t,"pending")),1),s("span",re,"In Progress: "+o(y(t,"in_progress")),1),s("span",ue,"Ready: "+o(y(t,"ready")+y(t,"ready_for_pickup")),1)])],10,oe))),128))])])):P("",!0)])]),_:1}))}},he=z(ve,[["__scopeId","data-v-dd177bad"]]);export{he as default};
