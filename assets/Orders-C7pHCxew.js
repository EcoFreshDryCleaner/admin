import{_ as M,i as q,r as u,j as $,k as z,c as l,a,e as m,f as k,O as D,P as C,l as S,m as w,b as n,o as i,t as o,q as g,d as x,F as L}from"./index-_H8X2coS.js";import{S as h,a as Q,g as G,b as J,u as W}from"./ordersService-Cw_fi6Tt.js";const X={class:"orders-container"},Y={class:"filters-section"},Z={class:"filters-row"},K={class:"filter-group"},ee={class:"filter-group"},te=["value"],ae={class:"filter-group"},se={class:"orders-card"},oe={class:"card-body"},le={key:0,class:"empty-state"},ie={key:1,class:"orders-table"},ne={class:"table-cell order-status"},de={class:"order-number"},ce={class:"order-status-badge"},re={class:"table-cell customer-info"},ue={class:"customer-name"},ve=["onClick"],pe={class:"toggle-text"},_e={key:0,class:"customer-details"},fe={class:"detail-item"},me={class:"detail-value"},ge={class:"detail-item"},he={class:"detail-value"},ye={class:"table-cell total-price"},be={class:"table-cell location-info"},ke={class:"location-name"},De={class:"service-type-badge"},Ce={key:0},Se=["onClick"],we={class:"toggle-text"},Pe={key:0,class:"pickup-address"},Oe={class:"address-value"},Ae={key:1},xe=["onClick"],Le={class:"toggle-text"},Ue={key:0,class:"dropoff-address"},Ne={class:"address-value"},Ve={class:"table-cell service-date"},$e={class:"table-cell items"},Fe={class:"table-cell actions"},Re=["onUpdate:modelValue","onChange"],Be={class:"stats-grid"},Ee={key:0,class:"location-stats-section"},Te={class:"location-stats-grid"},je=["onClick"],He={class:"location-stat-header"},Ie={class:"location-name"},Me={class:"location-count"},qe={class:"location-stat-breakdown"},ze={class:"stat-item"},Qe={class:"stat-item"},Ge={class:"stat-item"},Je={__name:"Orders",setup(We){const d=q(Q),c=u({total:0,pending:0,confirmed:0,picked_up:0,dropped_off:0,in_progress:0,cleaning:0,ready:0,ready_for_pickup:0,out_for_delivery:0,delivered:0,completed:0,cancelled:0,inProgress:0}),y=u(""),v=u(""),P=u("date_placed"),p=u(new Set);u(new Set);const _=u(new Set),f=u(new Set),O=$(()=>{if(!d.value)return[];const s=new Set;return d.value.forEach(t=>{t.service_location&&s.add(t.service_location)}),Array.from(s).sort()}),U=$(()=>{if(!d.value)return[];let s=d.value;return y.value&&(s=s.filter(t=>t.status===y.value)),v.value&&(s=s.filter(t=>t.service_location===v.value)),s=[...s].sort((t,e)=>{switch(P.value){case"date_placed":return new Date(e.date_placed?.toDate())-new Date(t.date_placed?.toDate());case"date_placed_asc":return new Date(t.date_placed?.toDate())-new Date(e.date_placed?.toDate());case"service_date":return new Date(e.service_date?.toDate())-new Date(t.service_date?.toDate());case"order_number":return t.order_number?.localeCompare(e.order_number);case"customer_name":return t.customer_name?.localeCompare(e.customer_name);case"total_price":return(e.total_price||0)-(t.total_price||0);default:return 0}}),s}),F=s=>s?new Date(s.toDate()).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A",R=s=>s.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" "),B=s=>J(s),A=s=>s?s.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" "):"Unknown Location",E=s=>d.value?d.value.filter(t=>t.service_location===s).length:0,b=(s,t)=>d.value?d.value.filter(e=>e.service_location===s&&e.status===t).length:0,T=s=>{p.value.has(s)?p.value.delete(s):p.value.add(s)},j=s=>{_.value.has(s)?_.value.delete(s):_.value.add(s)},H=s=>{f.value.has(s)?f.value.delete(s):f.value.add(s)},I=async(s,t)=>{try{await W(s,t),await N()}catch(e){console.error("Error updating order status:",e)}},N=async()=>{try{const s=await G();c.value=s}catch(s){console.error("Error loading orders stats:",s)}};return z(async()=>{await N()}),(s,t)=>(i(),l("div",X,[a("div",Y,[a("div",Z,[a("div",K,[t[4]||(t[4]=a("label",{for:"status-filter",class:"filter-label"},"Filter by Status:",-1)),k(a("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>y.value=e),id:"status-filter",class:"filter-select"},[...t[3]||(t[3]=[C('<option value="" data-v-e1890231>All Orders</option><option value="pending" data-v-e1890231>Pending</option><option value="confirmed" data-v-e1890231>Confirmed</option><option value="picked_up" data-v-e1890231>Picked Up</option><option value="dropped_off" data-v-e1890231>Dropped Off</option><option value="in_progress" data-v-e1890231>In Progress</option><option value="cleaning" data-v-e1890231>Cleaning</option><option value="ready" data-v-e1890231>Ready</option><option value="ready_for_pickup" data-v-e1890231>Ready for Pickup</option><option value="out_for_delivery" data-v-e1890231>Out for Delivery</option><option value="delivered" data-v-e1890231>Delivered</option><option value="completed" data-v-e1890231>Completed</option><option value="cancelled" data-v-e1890231>Cancelled</option>',13)])],512),[[D,y.value]])]),a("div",ee,[t[6]||(t[6]=a("label",{for:"location-filter",class:"filter-label"},"Filter by Location:",-1)),k(a("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>v.value=e),id:"location-filter",class:"filter-select"},[t[5]||(t[5]=a("option",{value:""},"All Locations",-1)),(i(!0),l(S,null,w(O.value,e=>(i(),l("option",{key:e,value:e},o(A(e)),9,te))),128))],512),[[D,v.value]])]),a("div",ae,[t[8]||(t[8]=a("label",{for:"sort-by",class:"filter-label"},"Sort by:",-1)),k(a("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>P.value=e),id:"sort-by",class:"filter-select"},[...t[7]||(t[7]=[C('<option value="date_placed" data-v-e1890231>Date Placed (Newest)</option><option value="date_placed_asc" data-v-e1890231>Date Placed (Oldest)</option><option value="service_date" data-v-e1890231>Service Date</option><option value="order_number" data-v-e1890231>Order Number</option><option value="customer_name" data-v-e1890231>Customer Name</option><option value="total_price" data-v-e1890231>Total Price</option>',6)])],512),[[D,P.value]])])])]),a("div",se,[t[14]||(t[14]=a("div",{class:"card-header"},[a("h3",{class:"card-title"},"Orders")],-1)),a("div",oe,[U.value.length===0?(i(),l("div",le,[...t[9]||(t[9]=[a("p",{class:"empty-text"},"No orders found",-1)])])):(i(),l("div",ie,[t[13]||(t[13]=C('<div class="table-header" data-v-e1890231><div class="table-cell" data-v-e1890231>Order # &amp; Status</div><div class="table-cell" data-v-e1890231>Customer</div><div class="table-cell" data-v-e1890231>Total</div><div class="table-cell" data-v-e1890231>Location</div><div class="table-cell" data-v-e1890231>Service Date</div><div class="table-cell" data-v-e1890231>Items</div><div class="table-cell" data-v-e1890231>Actions</div></div>',1)),(i(!0),l(S,null,w(U.value,e=>(i(),l("div",{key:e.id,class:"table-row"},[a("div",ne,[a("div",de,[a("strong",null,o(e.order_number),1)]),a("div",ce,[a("span",{class:g(["status-badge",`status-${e.status}`])},o(B(e.status)),3)])]),a("div",re,[a("div",ue,o(e.customer_name),1),a("button",{class:g(["customer-info-toggle",{expanded:p.value.has(e.id)}]),onClick:r=>T(e.id)},[a("span",pe,o(p.value.has(e.id)?"Hide Details":"Show Details"),1),n(x(L),{icon:p.value.has(e.id)?"fa-solid fa-chevron-up":"fa-solid fa-chevron-down",class:"toggle-icon"},null,8,["icon"])],10,ve),p.value.has(e.id)?(i(),l("div",_e,[a("div",fe,[a("span",me,o(e.customer_phone),1)]),a("div",ge,[a("span",he,o(e.customer_email),1)])])):m("",!0)]),a("div",ye,"$"+o(e.total_price),1),a("div",be,[a("div",ke,o(e.service_location_name||A(e.service_location)),1),a("div",De,[a("span",{class:g(["service-badge",`service-${e.service_type}`])},o(e.service_type==="pickup"?"Pick Up":"Drop Off"),3)]),e.service_type==="pickup"&&e.pickup_address?(i(),l("div",Ce,[a("button",{class:g(["address-toggle",{expanded:_.value.has(e.id)}]),onClick:r=>j(e.id)},[a("span",we,o(_.value.has(e.id)?"Hide Pickup Address":"Show Pickup Address"),1),n(x(L),{icon:_.value.has(e.id)?"fa-solid fa-chevron-up":"fa-solid fa-chevron-down",class:"toggle-icon"},null,8,["icon"])],10,Se),_.value.has(e.id)?(i(),l("div",Pe,[t[10]||(t[10]=a("div",{class:"address-label"},"Pickup Address:",-1)),a("div",Oe,o(e.pickup_address),1)])):m("",!0)])):m("",!0),e.service_type==="dropoff"&&e.service_location_address?(i(),l("div",Ae,[a("button",{class:g(["address-toggle",{expanded:f.value.has(e.id)}]),onClick:r=>H(e.id)},[a("span",Le,o(f.value.has(e.id)?"Hide Service Location":"Show Service Location"),1),n(x(L),{icon:f.value.has(e.id)?"fa-solid fa-chevron-up":"fa-solid fa-chevron-down",class:"toggle-icon"},null,8,["icon"])],10,xe),f.value.has(e.id)?(i(),l("div",Ue,[t[11]||(t[11]=a("div",{class:"address-label"},"Service Location:",-1)),a("div",Ne,o(e.service_location_address),1)])):m("",!0)])):m("",!0)]),a("div",Ve,o(F(e.service_date)),1),a("div",$e,[(i(!0),l(S,null,w(e.items,(r,V)=>(i(),l("div",{key:V,class:"item"},o(R(V))+": "+o(r),1))),128))]),a("div",Fe,[k(a("select",{"onUpdate:modelValue":r=>e.status=r,onChange:r=>I(e.id,e.status),class:"status-select"},[...t[12]||(t[12]=[C('<option value="pending" data-v-e1890231>Pending</option><option value="confirmed" data-v-e1890231>Confirmed</option><option value="picked_up" data-v-e1890231>Picked Up</option><option value="dropped_off" data-v-e1890231>Dropped Off</option><option value="in_progress" data-v-e1890231>In Progress</option><option value="cleaning" data-v-e1890231>Cleaning</option><option value="ready" data-v-e1890231>Ready</option><option value="ready_for_pickup" data-v-e1890231>Ready for Pickup</option><option value="out_for_delivery" data-v-e1890231>Out for Delivery</option><option value="delivered" data-v-e1890231>Delivered</option><option value="completed" data-v-e1890231>Completed</option><option value="cancelled" data-v-e1890231>Cancelled</option>',12)])],40,Re),[[D,e.status]])])]))),128))]))])]),a("div",Be,[n(h,{icon:"fa-solid fa-shopping-bag",label:"Total Orders",value:c.value.total},null,8,["value"]),n(h,{icon:"fa-solid fa-clock",label:"Pending",value:c.value.pending},null,8,["value"]),n(h,{icon:"fa-solid fa-spinner",label:"In Progress",value:c.value.inProgress},null,8,["value"]),n(h,{icon:"fa-solid fa-soap",label:"Cleaning",value:c.value.cleaning},null,8,["value"]),n(h,{icon:"fa-solid fa-check-circle",label:"Ready",value:c.value.ready+c.value.ready_for_pickup},null,8,["value"]),n(h,{icon:"fa-solid fa-truck",label:"Out for Delivery",value:c.value.out_for_delivery},null,8,["value"])]),O.value.length>1?(i(),l("div",Ee,[t[15]||(t[15]=a("h3",{class:"location-stats-title"},"Orders by Location",-1)),a("div",Te,[(i(!0),l(S,null,w(O.value,e=>(i(),l("div",{key:e,class:g(["location-stat-card",{"active-location":v.value===e}]),onClick:r=>v.value=v.value===e?"":e},[a("div",He,[a("h4",Ie,o(A(e)),1),a("span",Me,o(E(e)),1)]),a("div",qe,[a("span",ze,"Pending: "+o(b(e,"pending")),1),a("span",Qe,"In Progress: "+o(b(e,"in_progress")),1),a("span",Ge,"Ready: "+o(b(e,"ready")+b(e,"ready_for_pickup")),1)])],10,je))),128))])])):m("",!0)]))}},Ze=M(Je,[["__scopeId","data-v-e1890231"]]);export{Ze as default};
